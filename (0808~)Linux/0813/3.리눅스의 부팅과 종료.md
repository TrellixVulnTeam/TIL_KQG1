# **리눅스의** **부팅과 종료**

#### n**리눅스** **시스템의** **부팅 과정**

![linuxbooting](https://user-images.githubusercontent.com/50945713/62909550-fba3ed80-bdb7-11e9-8de5-2cb63b8cd8e7.png)



#### **바이오스** **단계**

- PC의 전원 스위치를 켜서 부팅하면 제일 먼저 바이오스(BIOS, basic input/output system)가 동작

- 바이오스는 PC에 장착된 기본적인 하드웨어(키보드, 디스크 등)의 상태를 확인한 후 부팅 장치를 선택하여 부팅 디스크의 첫 섹터에서 512바이트를 로딩

- 이 512바이트가 마스터 부트 레코드(master boot record, MBR): 2차 부팅 프로그램(부트 로더)의 위치 저장

![bios](https://user-images.githubusercontent.com/50945713/62909623-4291e300-bdb8-11e9-93c4-89437fb28e20.png)



#### 부트 로더 단계

- 바이오스 단계에서 MBR는 부트 로더를 찾아 메모리에 로딩

- 부트 로더는 여러 운영체제 중에서 부팅할 운영체제를 선택할 수 있도록 메뉴를 제공

- 부트 로더는 리눅스 커널을 메모리에 로딩

- 리눅스 커널은 /boot 디렉터리 아래에 ‘vmlinuz-버전명’의 형태로 제공

- 리눅스의 대표적인 부트 로더로는 GRUB와 LILO

  

#### 커널 초기화 단계
- 커널은 가장 먼저 시스템에 연결된 메모리, 디스크, 키보드, 마우스 등 장치들을 검사

- 장치 검사 등 기본적인 초기화 과정이 끝나면 커널은 fork를 사용하지 않고 생성되는 프로세스와 스레드 생성
  - 이 프로세스들은 메모리 관리 같은 커널의 여러 가지 동작을 수행
  - 이들 프로세스는 일반적인 프로세스와 구분되도록 대괄호([ ])로 표시하며, 주로 PID 번호가 낮게 배정

#### systemd 서비스 단계

우분투에서 systemd 서비스는 기존의 init 스크립트를 대체한 것으로 다양한 서비스를 동작
각 서비스가 시작하는 과정은 화면에 메시지로 출력


부트 스플래시 화면이 바로 종료되고 [그림 8-6]과 같이 메시지가 출력되는 화면으로 전환

부팅시 출력된 메시지는 dmesg 명령이나 more /var/log/boot.log
명령으로 확인 가능



systemd 서비스

​	init프로세스와 런레벨

​		init 프로세스에서 사용하던 런레벨(Run Level)의 개념에 대한 이해 필요

​		init는 시스템의 단계를 일곱 개로 정의하여 구분하고 각 단계에 따라 셸 스크립트를 실행하는데, 이 단계들을 런레벨이라고 함

​		런레벨 2, 3, 4번이 동일하다는 것은 /etc/rc2.d, /etc/rc3.d, /etc/rc4.d 디렉터리의 내용이 모두 같다는 것으로 알 수 있음

​		런레벨별로 실행하는 스크립트 파일은 /etc/init.d 디렉터리에 있는 파일에 대한 심벌릭 링크

### systemd의 기본 개념	

- systemd는 init 방식에 비해 다음과 같은 장점을 가지고 있음
- 소켓 기반으로 동작하여 inetd와 호환성을 유지한다.

- 셸과 독립적으로 부팅이 가능하다.

- 마운트 제어가 가능하다.

- fsck 제어가 가능하다.

- 시스템 상태에 대한 스냅숏을 유지한다.

- SELinux와 통합이 가능하다.

- 서비스에 시그널을 전달할 수 있다.

- shutdown 전에 사용자 세션의 안전한 종료가 가능하다.

### systemd 유닛
- 전체 시스템을 시작하고 관리하는 데 유닛(unit)이라 부르는 구성 요소를 사용

- systemd는 관리 대상의 이름을 ‘서비스명.유닛 종류’의 형태로 관리

- 각 유닛은 같은 이름과 종류로 구성된 설정 파일과 동일한 이름을 사용

- 유닛과 관련한 보다 자세한 내용은 ‘man systemd.유닛명’으로 확인

### systemd 관련 명령

- systemd 기반으로 서비스를 시작하거나 종료할 때 사용하는 명령: systemctl

## 리눅스 시스템의 종료

### 리눅스 종료 방법

- shutdown 명령을 사용한다.
- halt 명령을 사용한다.
- poweroff 명령을 사용한다.
- 런레벨을 0이나 6으로 전환한다(target을 전환한다).
- reboot 명령을 사용한다.
- 전원을 끈다.







